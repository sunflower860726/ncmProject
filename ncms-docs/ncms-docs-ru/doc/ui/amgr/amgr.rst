.. _amgr:

Управление сборками
===================

В этом интерфейсе администратор может задать структуру :term:`сборок <сборка>` (страниц) ηCMS,
определить типы возможных страниц и напрямую редактировать :term:`атрибуты <атрибут>`
любой сборки. С этого интерфейса начинается создание концепции и логической
структуры будущих страниц сайта.

Доступ к данному интерфейсу имеют пользователи с правами доступа
`admin` или `admin.asm`.


.. figure:: img/amgr_img1.png

    Общий вид интерфейса управления сборками

Форма поиска
------------

В форме поиска слева можно выбрать:

* :term:`сборку <сборка>` с атрибутами,
* :term:`шаблон` страницы сайта или новости,
* :term:`экземпляр страницы <страница>`.

Иконка напротив каждого элемента в списке сборок обозначает тип сборки:

.. image:: img/amgr_other.png
    :align: left

Простая сборка с атрибутами, которая не является :term:`шаблоном <шаблон>` или экземпляром страницы.
Сборки данного типа могут присутствовать в иерархии наследования сборок,
предоставляя наследникам свои атрибуты.

.. image:: img/amgr_template.png
    :align: left

Именованный :term:`шаблон <шаблон>` для страниц сайта,
на основе которого создаются типовые страницы.


.. image:: img/amgr_page.png
    :align: left

Экземпляр страницы, который является сборкой с уникальным
именем в :term:`GUID формате <GUID страницы>`, и для которого
определена :term:`разметка <ядро>`.

.. image:: img/amgr_news.png
    :align: left

Экземпляр :ref:`ленты событий (новости) <news>`.


Управление сборкой
------------------

.. figure:: img/amgr_img2.png

    Шаблон страницы с именем "Страница с контентом и возможностью указать разметку"


**Название** -- название сборки. Для экземпляров страниц это :term:`уникальный GUID <GUID страницы>`.

**Разметка** -- :ref:`HTTL <httl>`  файл разметки страницы.

**Описание** -- краткое описание сборки. Значение данного поля отображается
в форме поиска страниц. А также используется при выборе :term:`шаблона <шаблон>` для страниц.

**Контроллер** -- опциональное имя java класса, который реализует интерфейс `com.softmotions.ncms.asm.render.AsmController`
и вызывается при отображении страницы сайта. Контроллер может совершить
дополнительные действия при отображении страницы или изменть HTTP ответ.
Дополнительно смотрите раздел :ref:`расширение ηCMS <extending>`.

**Опубликовано** -- Флаг публикации страницы. Когда он включен,
страница будет отображена клиентам сайта, а если для страницы флаг снят, то
ηCMS ответит 404 HTTP кодом.

**Шаблон**. Если выбрана `Страница`
и для сборки определена :term:`разметка <ядро>`, то эта сборка будет
шаблоном для типовых страниц сайта. А именем шаблона - значение поля `Описание`.
Опция `Новость` определяет эту страницу как шаблон для элементов ленты
новостей.

**Роли** -- список ролей прав доступа через запятую. Наличие одной из ролей у
пользователя необходимо для создания страницы на основе данной сборки.
Сборка в этом случае должна быть в режиме шаблона (**Шаблон**). Если
данный список пуст, любой пользователь сможет создать страницу на основе
этой сборки.

**Родители** -- родительские сборки для текущей сборки. Позволяет текущей сборке
наследовать атрибуты родительских сборок (по аналогии с множественным наследованием
классов в ООП).

**Атрибуты** -- доступные атрибуты в сборке, включая собственные атрибуты и
наследуемые атрибуты.

.. figure:: img/amgr_img9.png

    Список атрибутов, связанных со страницей


**Возможные операции над атрибутами:**

.. image:: img/amgr_img3.png
    :align: left

Создание нового атрибута. В этом случае отобразится диалоговое окно выбора возможных
атрибутов:

.. figure:: img/amgr_img6.png

    Диалог выбора нового :term:`атрибута <атрибут>`

:ref:`Описание возможных атрибутов сборок <am>`

После выбора атрибута, ηCMS предложит настроить параметры атрибута.

.. image:: img/amgr_img4.png
    :align: left

Удаление выбранного атрибута. При этом удалить можно только атрибуты,
принадлежащие текущей странице, но не атрибуты в базовых сборках по цепочке наследования.

.. image:: img/amgr_img5.png
    :align: left

Открыть опции атрибута для редактирования. При этом редактировать можно только атрибуты,
принадлежащие текущей странице, но не атрибуты в базовых сборках по цепочке наследования.
В случае, если для редактирования будет открыт атрибут базовой (родительской)
сборки, ηCMS создаст копию атрибута в текущей странице и пометит этот атрибут значком |img_star|.
В этом случае атрибут переопределит атрибут родителя (по аналогии с переопределением функций
в объектно-ориентированных языках программирования). Наследуемые атрибуты базовых сборок отображаются
на сером фоне: |img_grey| и не могут быть удалены из сборки.

.. image:: img/amgr_img10.png
    :align: left

Переместить выбранный атрибут **вверх**. В этом случае меняется порядок атрибутов
в :ref:`интерфейсе редактирования содержимого страницы <pmgr>`.

.. image:: img/amgr_img11.png
    :align: left

Переместить выбранный атрибут **вниз**. В этом случае меняется порядок атрибутов
в :ref:`интерфейсе редактирования содержимого страницы <pmgr>`.


.. |img_star| image:: img/amgr_img7.png
.. |img_grey| image:: img/amgr_img8.png


